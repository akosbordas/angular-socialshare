"use strict";function debounce(e,t,n){var o;return function(){var r=this,i=arguments,c=function(){o=null,n||e.apply(r,i)},a=n&&!o;clearTimeout(o),o=setTimeout(c,t),a&&e.apply(r,i)}}function randomString(e,t){t=t&&t.toLowerCase();for(var n="",o=0,r="a"==t?10:0,i="n"==t?10:62;o++<e;){var c=Math.random()*(i-r)+r<<0;n+=String.fromCharCode(c+=c>9?36>c?55:61:48)}return n}angular.module("djds4rce.angular-socialshare",[]).factory("$FB",["$window",function(e){return{init:function(t){if(!t)throw"FB App Id Cannot be blank";this.fbId=t,e.fbAsyncInit=function(){FB.init({appId:t,channelUrl:"app/channel.html",status:!0,xfbml:!0})},function(e){var t,n="facebook-jssdk",o=e.getElementsByTagName("script")[0];e.getElementById(n)||(t=e.createElement("script"),t.id=n,t.async=!0,t.src="//connect.facebook.net/en_US/all.js",o.parentNode.insertBefore(t,o))}(document)}}}]).directive("facebook",["$http",function(e){return{scope:{callback:"=",shareButtonText:"=",shares:"="},transclude:!0,templateUrl:"templates/facebook.html",link:function(t,n,o){t.shareButtonText=t.shareButtonText||"Share",o.$observe("url",function(){o.shares&&o.url&&e.get("https://api.facebook.com/method/links.getStats?urls="+o.url+"&format=json").success(function(e){var n=e[0]&&e[0].total_count?e[0].total_count.toString():0,o="";n.length>6?("0"!=n.slice(-6,-5)&&(o="."+n.slice(-6,-5)),n=n.slice(0,-6),n=n+o+"M"):n.length>3&&("0"!=n.slice(-3,-2)&&(o="."+n.slice(-3,-2)),n=n.slice(0,-3),n=n+o+"k"),t.shares=n}).error(function(){t.shares=0}),n.unbind(),n.bind("click",function(e){FB.ui({method:"share",href:o.url},function(e){void 0!==t.callback&&"function"==typeof t.callback&&t.callback(e)}),e.preventDefault()})})}}}]).directive("facebookFeedShare",["$http",function(e){return{scope:{callback:"=",shareButtonText:"=",shares:"="},transclude:!0,templateUrl:"templates/facebook-feed-share.html",link:function(t,n,o){t.shareButtonText=t.shareButtonText||"Share",o.$observe("url",function(){o.shares&&o.url&&e.get("https://api.facebook.com/method/links.getStats?urls="+o.url+"&format=json").success(function(e){var n=e[0]?e[0].total_count.toString():0,o="";n.length>6?("0"!=n.slice(-6,-5)&&(o="."+n.slice(-6,-5)),n=n.slice(0,-6),n=n+o+"M"):n.length>3&&("0"!=n.slice(-3,-2)&&(o="."+n.slice(-3,-2)),n=n.slice(0,-3),n=n+o+"k"),t.shares=n}).error(function(){t.shares=0}),n.unbind(),n.bind("click",function(e){FB.ui({method:"feed",link:o.url,picture:o.picture,name:o.name,caption:o.caption,description:o.description},function(e){void 0!==t.callback&&"function"==typeof t.callback&&t.callback(e)}),e.preventDefault()})})}}}]).directive("twitter",["$timeout",function(e){return{link:function(t,n,o){var r=debounce(function(){o.url&&e(function(){n[0].innerHTML="",twttr.widgets.createShareButton(o.url,n[0],function(){},{count:o.count,text:o.text,via:o.via,size:o.size})})},75);o.$observe("url",r),o.$observe("text",r)}}}]).directive("linkedin",["$timeout","$http","$window",function(e,t,n){return{scope:{shares:"=",shareButtonText:"="},transclude:!0,templateUrl:"templates/linkedin.html",link:function(o,r,i){o.shareButtonText=o.shareButtonText||"Share";var c=debounce(function(){i.shares&&i.url&&t.jsonp("https://www.linkedin.com/countserv/count/share?url="+i.url+"&callback=JSON_CALLBACK&format=jsonp").success(function(e){o.shares=e.count.toLocaleString()}).error(function(){o.shares=0}),e(function(){r.unbind(),r.bind("click",function(){var e=encodeURIComponent(i.url).replace(/'/g,"%27").replace(/"/g,"%22");n.open("//www.linkedin.com/shareArticle?mini=true&url="+e+"&title="+i.title+"&summary="+i.summary)})})},100);i.$observe("url",c),i.$observe("title",c),i.$observe("summary",c)}}}]).directive("gplus",[function(){return{link:function(e,t,n){var o=debounce(function(){"undefined"==typeof gapi?!function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://apis.google.com/js/platform.js",e.onload=r;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}():r()},100),r=function(e,n){return function(){var e=document.createElement("div"),o=n.id||randomString(5);n.id=o,e.setAttribute("id",o),t.innerHTML="",t.append(e),n["class"]&&-1!=n["class"].indexOf("g-plusone")?window.gapi.plusone.render(o,n):window.gapi.plus.render(o,n)}}(t,n);n.$observe("href",o)}}}]).directive("tumblrText",[function(){return{link:function(e,t,n){var o=document.createElement("a"),r=debounce(function(){o.setAttribute("href","https://www.tumblr.com/share/link?url="+encodeURIComponent(n.url)+"&name="+encodeURIComponent(n.name)+"&description="+encodeURIComponent(n.description)),o.setAttribute("title",n.title||"Share on Tumblr"),o.setAttribute("style",n.styling||"display:inline-block; text-indent:-9999px; overflow:hidden; width:81px; height:20px; background:url('https://platform.tumblr.com/v1/share_1.png') top left no-repeat transparent;"),t[0].innerHTML="",t.append(o)},100);n.$observe("url",r),n.$observe("name",r),n.$observe("description",r)}}}]).directive("tumblrQoute",[function(){return{link:function(e,t,n){var o=document.createElement("a"),r=debounce(function(){o.setAttribute("href","https://www.tumblr.com/share/quote?quote="+encodeURIComponent(n.qoute)+"&source="+encodeURIComponent(n.source)),o.setAttribute("title",n.title||"Share on Tumblr"),o.setAttribute("style",n.styling||"display:inline-block; text-indent:-9999px; overflow:hidden; width:81px; height:20px; background:url('https://platform.tumblr.com/v1/share_1.png') top left no-repeat transparent;"),t[0].innerHTML="",t.append(o)},100);n.$observe("qoute",r),n.$observe("source",r)}}}]).directive("tumblrImage",[function(){return{link:function(e,t,n){var o=document.createElement("a"),r=debounce(function(){o.setAttribute("href","https://www.tumblr.com/share/photo?source="+encodeURIComponent(n.source)+"&caption="+encodeURIComponent(n.caption)+"&clickthru="+encodeURIComponent(n.clickthru)),o.setAttribute("title",n.title||"Share on Tumblr"),o.setAttribute("style",n.styling||"display:inline-block; text-indent:-9999px; overflow:hidden; width:81px; height:20px; background:url('https://platform.tumblr.com/v1/share_1.png') top left no-repeat transparent;"),t[0].innerHTML="",t.append(o)},100);n.$observe("source",r),n.$observe("caption",r),n.$observe("clickthru",r)}}}]).directive("tumblrVideo",[function(){return{link:function(e,t,n){var o=document.createElement("a"),r=debounce(function(){o.setAttribute("href","https://www.tumblr.com/share/video?embed="+encodeURIComponent(n.embedcode)+"&caption="+encodeURIComponent(n.caption)),o.setAttribute("title",n.title||"Share on Tumblr"),o.setAttribute("style",n.styling||"display:inline-block; text-indent:-9999px; overflow:hidden; width:81px; height:20px; background:url('https://platform.tumblr.com/v1/share_1.png') top left no-repeat transparent;"),t[0].innerHTML="",t.append(o)},100);n.$observe("embedcode",r),n.$observe("caption",r)}}}]).directive("pintrest",["$window","$timeout",function(e,t){return{template:'<a href="{{href}}" data-pin-do="{{pinDo}}" data-pin-config="{{pinConfig}}"><img src="//assets.pinterest.com/images/pidgets/pinit_fg_en_rect_gray_20.png" /></a>',link:function(n,o,r){var i=debounce(function(){var n=document.createElement("a");n.setAttribute("href","//www.pinterest.com/pin/create/button/?url="+encodeURIComponent(r.href)+"&media="+encodeURIComponent(r.img)+"&description="+encodeURIComponent(r.description)),n.setAttribute("pinDo",r.pinDo||"buttonPin"),n.setAttribute("pinConfig",r.pinConfig||"beside"),o[0].innerHTML="",o.append(n),t(function(){e.parsePins(o)})},100);r.$observe("href",i),r.$observe("img",i),r.$observe("description",i)}}}]);